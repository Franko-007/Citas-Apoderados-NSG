<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gesti칩n de Citas Liceo NSG</title>
    <!-- Agregar estas l칤neas en el <head> del index.html, despu칠s de la l칤nea del t칤tulo -->

<link rel="icon" type="image/png" href="https://i.postimg.cc/sxxwfhwK/LOGO-LBSNG-06-237x300.png">
<link rel="apple-touch-icon" href="https://i.postimg.cc/sxxwfhwK/LOGO-LBSNG-06-237x300.png">
    <link rel="stylesheet" href="style.css">
    <!-- Script de limpieza de duplicados ANTES de cargar todo -->
    <script>
        // Limpieza autom치tica de duplicados
        (function() {
            if (window.limpiezaRealizada) return;
            window.limpiezaRealizada = true;
            
            window.addEventListener('DOMContentLoaded', function() {
                setTimeout(function() {
                    const headers = document.querySelectorAll('.main-header');
                    const containers = document.querySelectorAll('.app-container');
                    
                    console.log('Headers encontrados:', headers.length);
                    console.log('Containers encontrados:', containers.length);
                    
                    // Si hay m치s de uno, eliminar los duplicados
                    if (headers.length > 1) {
                        console.warn('丘멆잺 Duplicados detectados, eliminando...');
                        for (let i = 1; i < headers.length; i++) {
                            if (headers[i].parentElement) {
                                headers[i].parentElement.remove();
                            }
                        }
                    }
                    
                    if (containers.length > 1) {
                        for (let i = 1; i < containers.length; i++) {
                            containers[i].remove();
                        }
                    }
                }, 100);
            });
        })();
    </script>
</head>
<body>

<header class="main-header">
    <div class="header-content">
        <img src="https://i.postimg.cc/sxxwfhwK/LOGO-LBSNG-06-237x300.png" class="logo-img" alt="Logo LBSNG">
        <h1>Gesti칩n de Citas Liceo Bicentenario NSG</h1>
    </div>
</header>

<div class="app-container">
    <aside class="sidebar">
        <button class="btn-dashboard" onclick="location.href='dashboard.html'">游늵 Ver Dashboard</button>

        <div class="mini-calendar">
            <div class="mini-cal-header">
                <button onclick="changeMonth(-1)">춺</button>
                <span id="miniMonthLabel"></span>
                <button onclick="changeMonth(1)">췉</button>
            </div>
            <div class="mini-cal-grid-labels">
                <span>L</span><span>M</span><span>X</span><span>J</span><span>V</span><span>S</span><span class="sun-red">D</span>
            </div>
            <div id="miniCalendar" class="mini-cal-grid-days"></div>
        </div>

        <div class="filter-group">
            <label>Filtrar por Docente</label>
            <input type="text" id="filterDocente" oninput="renderWeekView()" list="listaDocentes" placeholder="Buscar docente...">
        </div>
        
        <div class="leyenda-citas">
            <div class="leyenda-item">
                <span class="leyenda-color asis"></span>
                <span>Asisti칩</span>
            </div>
            <div class="leyenda-item">
                <span class="leyenda-color pen"></span>
                <span>Pendiente</span>
            </div>
            <div class="leyenda-item">
                <span class="leyenda-color no"></span>
                <span>No asisti칩</span>
            </div>
            <div class="leyenda-item">
                <span class="leyenda-color reagendada"></span>
                <span>Reagendada</span>
            </div>
        </div>
    </aside>

    <main class="calendar-main">
        <div class="calendar-controls">
            <button onclick="changeWeek(-1)">춺 Anterior</button>
            <h2 id="weekRangeLabel">Cargando semana...</h2>
            <button onclick="changeWeek(1)">Siguiente 췉</button>
        </div>

        <div class="table-container">
            <div id="timeLabels" class="time-column"></div>
            <div id="weekGrid" class="week-grid"></div>
        </div>
    </main>
</div>

<dialog id="dialog" class="modal-clean">
    <div class="modal-body">
        <h2 class="modal-title">Gesti칩n de Citaci칩n</h2>
        <input type="hidden" id="citaId">

        <div class="form-row-split">
            <div class="form-group">
                <label>Fecha</label>
                <input type="date" id="fecha">
            </div>
            <div class="form-group">
                <label>Hora</label>
                <input type="time" id="hora">
            </div>
        </div>

        <div class="form-group" style="position:relative;">
            <label>Docente</label>
            <input type="text" id="docente" placeholder="Buscar docente..." autocomplete="off" oninput="filtrarDocentes()">
            <div id="docenteList" class="autocomplete-list"></div>
        </div>

        <div class="form-group">
            <label>Email Docente</label>
            <input type="email" id="emailDocente" placeholder="docente@liceonsg.cl">
        </div>

        <div class="form-row-split">
            <div class="form-group">
                <label>Sala</label>
                <select id="sala">
                    <option value="Sala 1">Sala 1</option>
                    <option value="Sala 2">Sala 2</option>
                    <option value="Biblioteca">Biblioteca</option>
                    <option value="UTP">UTP</option>
                    <option value="Sala de Enlaces">Sala de Enlaces</option>
                </select>
            </div>
            <div class="form-group">
                <label>Estado</label>
                <select id="estado">
                    <option value="Pendiente">Pendiente</option>
                    <option value="Asisti칩">Asisti칩</option>
                    <option value="No asisti칩">No asisti칩</option>
                    <option value="Reagendada">Reagendada</option>
                </select>
            </div>
        </div>

        <div class="form-row-split">
            <div class="form-group">
                <label>Nombre del Alumno</label>
                <input id="alumno" placeholder="Ingrese Alumno">
            </div>
            <div class="form-group">
                <label>Nombre del Apoderado</label>
                <input id="apoderado" placeholder="Ingrese Apoderado">
            </div>
        </div>

        <div class="form-group">
            <label>Email Apoderado</label>
            <input type="email" id="emailApoderado" placeholder="apoderado@gmail.com">
        </div>

        <div class="form-group">
            <label>Curso</label>
            <select id="curso">
                <option value="">Seleccione curso</option>
                <option>Pre Kinder</option><option>Kinder A</option><option>Kinder B</option>
                <option>1춿 B치sico A</option><option>1춿 B치sico B</option><option>2춿 B치sico A</option><option>2춿 B치sico B</option>
                <option>3춿 B치sico A</option><option>3춿 B치sico B</option><option>4춿 B치sico A</option><option>4춿 B치sico B</option>
                <option>5춿 B치sico A</option><option>5춿 B치sico B</option><option>6춿 B치sico A</option><option>6춿 B치sico B</option>
                <option>7춿 B치sico A</option><option>7춿 B치sico B</option><option>8춿 B치sico A</option><option>8춿 B치sico B</option>
                <option>I춿 Medio A</option><option>I춿 Medio B</option><option>II춿 Medio A</option><option>II춿 Medio B</option>
                <option>III춿 Medio A</option><option>III춿 Medio B</option><option>IV춿 Medio A</option><option>IV춿 Medio B</option>
            </select>
        </div>

        <input type="hidden" id="tipoCita" value="Email">

        <div class="modal-actions-stack">
            <button class="btn-primary-full" id="btnGuardar" onclick="guardar()">Guardar</button>
            <button class="btn-danger-full" id="btnReagendar" onclick="reagendar()">Reagendar</button>
            <button class="btn-secondary-full" onclick="closeDialog()">Cerrar</button>
        </div>
    </div>
</dialog>

<datalist id="listaDocentes"></datalist>

<footer class="main-footer">
    춸 NSG 2026 - Derechos Reservados - Desarrollado por Franco.
</footer>

<script src="script.js"></script>
</body>
</html>
